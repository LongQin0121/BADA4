<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>控制中的约束处理</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.3);
        }
        
        h1 {
            text-align: center;
            font-size: 2.8em;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .intro-section {
            background: linear-gradient(145deg, rgba(255,255,255,0.2), rgba(255,255,255,0.1));
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
            border-left: 5px solid #ffd700;
            text-align: center;
        }
        
        .constraints-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 25px;
            margin: 30px 0;
        }
        
        .constraint-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            color: #333;
            box-shadow: 0 4px 16px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .constraint-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 32px rgba(0,0,0,0.3);
        }
        
        .physical { border-top: 5px solid #e74c3c; }
        .performance { border-top: 5px solid #f39c12; }
        .safety { border-top: 5px solid #27ae60; }
        
        .constraint-icon {
            font-size: 3em;
            text-align: center;
            margin-bottom: 15px;
        }
        
        .constraint-title {
            font-size: 1.5em;
            font-weight: bold;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .constraint-examples {
            list-style: none;
            padding: 0;
        }
        
        .constraint-examples li {
            background: rgba(52, 152, 219, 0.1);
            margin: 10px 0;
            padding: 12px;
            border-radius: 8px;
            border-left: 3px solid #3498db;
            transition: all 0.3s ease;
        }
        
        .constraint-examples li:hover {
            background: rgba(52, 152, 219, 0.2);
            transform: translateX(5px);
        }
        
        .comparison-section {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin: 40px 0;
        }
        
        .method-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            color: #333;
            box-shadow: 0 4px 16px rgba(0,0,0,0.2);
        }
        
        .classical { border-left: 5px solid #e74c3c; }
        .predictive { border-left: 5px solid #2ecc71; }
        
        .method-title {
            font-size: 1.8em;
            font-weight: bold;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .classical .method-title { color: #e74c3c; }
        .predictive .method-title { color: #2ecc71; }
        
        .code-block {
            background: #2d3748;
            color: #e2e8f0;
            padding: 15px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            margin: 15px 0;
            overflow-x: auto;
        }
        
        .graph-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
            border: 2px solid #ddd;
            position: relative;
        }
        
        .graph-title {
            font-size: 1.2em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
        }
        
        .graph-visual {
            height: 200px;
            position: relative;
            background: linear-gradient(to bottom, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 15px 0;
        }
        
        .line {
            position: absolute;
            height: 3px;
            background: #3498db;
        }
        
        .constraint-line {
            position: absolute;
            height: 2px;
            background: #e74c3c;
            border-top: 2px dashed #e74c3c;
        }
        
        .setpoint {
            position: absolute;
            width: 8px;
            height: 8px;
            background: #f39c12;
            border-radius: 50%;
        }
        
        .pros-cons-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }
        
        .pros, .cons {
            padding: 15px;
            border-radius: 8px;
        }
        
        .pros {
            background: rgba(46, 204, 113, 0.1);
            border-left: 4px solid #2ecc71;
        }
        
        .cons {
            background: rgba(231, 76, 60, 0.1);
            border-left: 4px solid #e74c3c;
        }
        
        .optimal-operation {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
            color: #333;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }
        
        .operation-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin: 20px 0;
        }
        
        .operation-scenario {
            border-radius: 12px;
            padding: 20px;
            text-align: center;
        }
        
        .suboptimal {
            background: rgba(231, 76, 60, 0.1);
            border: 2px solid #e74c3c;
        }
        
        .optimal {
            background: rgba(46, 204, 113, 0.1);
            border: 2px solid #2ecc71;
        }
        
        .example-scenarios {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 25px;
            margin: 25px 0;
            color: #333;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }
        
        .scenario-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        
        .scenario-card {
            background: linear-gradient(145deg, #f8f9fa, #e9ecef);
            border-radius: 10px;
            padding: 20px;
            border-left: 4px solid #3498db;
        }
        
        .highlight-stat {
            background: linear-gradient(145deg, rgba(255,255,255,0.3), rgba(255,255,255,0.2));
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            margin: 15px 0;
        }
        
        .stat-number {
            font-size: 2.5em;
            font-weight: bold;
            color: #ffd700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .stat-label {
            font-size: 1.1em;
            margin-top: 10px;
        }
        
        @media (max-width: 768px) {
            .comparison-section {
                grid-template-columns: 1fr;
            }
            
            .operation-comparison {
                grid-template-columns: 1fr;
            }
            
            .pros-cons-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>⚙️ 控制中的约束处理</h1>
        
        <div class="intro-section">
            <h2 style="color: #ffd700; margin-top: 0;">🎯 核心问题</h2>
            <p style="font-size: 1.3em;">
                <strong>所有物理系统都有约束</strong><br>
                最优操作点往往接近约束边界<br>
                约束处理方式决定了控制系统的性能上限
            </p>
        </div>
        
        <h2 style="text-align: center; margin: 40px 0;">📋 约束的三大类型</h2>
        
        <div class="constraints-grid">
            <div class="constraint-card physical">
                <div class="constraint-icon">⚙️</div>
                <h3 class="constraint-title">物理约束</h3>
                <p style="text-align: center; font-style: italic;">硬件和执行器的物理限制</p>
                <ul class="constraint-examples">
                    <li><strong>执行器饱和</strong> - 电机最大转矩、阀门开度 0-100%</li>
                    <li><strong>传感器范围</strong> - 温度计测量范围、压力传感器上限</li>
                    <li><strong>机械限制</strong> - 机械臂关节角度、车辆最大转角</li>
                    <li><strong>电气限制</strong> - 最大电流、电压范围</li>
                    <li><strong>流量限制</strong> - 泵的最大流量、管道容量</li>
                </ul>
                <div class="code-block">
# 物理约束示例
u_min ≤ u(t) ≤ u_max    # 控制输入限制
y_min ≤ y(t) ≤ y_max    # 输出变量限制
|du/dt| ≤ rate_limit    # 变化率限制
                </div>
            </div>
            
            <div class="constraint-card performance">
                <div class="constraint-icon">📊</div>
                <h3 class="constraint-title">性能约束</h3>
                <p style="text-align: center; font-style: italic;">系统性能指标的要求</p>
                <ul class="constraint-examples">
                    <li><strong>超调量限制</strong> - 系统响应不能超过设定值的10%</li>
                    <li><strong>稳定时间</strong> - 要求在5秒内达到稳态</li>
                    <li><strong>稳态误差</strong> - 跟踪误差小于1%</li>
                    <li><strong>振荡限制</strong> - 阻尼比大于0.7</li>
                    <li><strong>能耗约束</strong> - 控制能耗不超过预算</li>
                </ul>
                <div class="code-block">
# 性能约束示例  
overshoot ≤ 10%          # 超调量约束
settling_time ≤ 5s       # 稳定时间约束
|e_ss| ≤ 1%             # 稳态误差约束
ζ ≥ 0.7                 # 阻尼比约束
                </div>
            </div>
            
            <div class="constraint-card safety">
                <div class="constraint-icon">🛡️</div>
                <h3 class="constraint-title">安全约束</h3>
                <p style="text-align: center; font-style: italic;">系统安全运行的边界条件</p>
                <ul class="constraint-examples">
                    <li><strong>温度限制</strong> - 反应器温度不超过安全上限</li>
                    <li><strong>压力边界</strong> - 管道压力保持在安全范围</li>
                    <li><strong>碰撞避免</strong> - 机器人与障碍物保持安全距离</li>
                    <li><strong>化学安全</strong> - 有毒物质浓度限制</li>
                    <li><strong>结构保护</strong> - 应力不超过材料强度</li>
                </ul>
                <div class="code-block">
# 安全约束示例
T(t) ≤ T_max            # 温度安全上限
P(t) ≤ P_safe           # 压力安全边界  
distance ≥ d_min        # 最小安全距离
concentration ≤ C_limit  # 浓度限制
                </div>
            </div>
        </div>
        
        <div class="highlight-stat">
            <div class="stat-number">80%</div>
            <div class="stat-label">工业控制问题都涉及约束处理</div>
        </div>
        
        <h2 style="text-align: center; margin: 40px 0;">⚖️ 两种约束处理方法对比</h2>
        
        <div class="comparison-section">
            <div class="method-card classical">
                <h3 class="method-title">🎛️ 经典控制方法</h3>
                
                <h4>约束处理策略</h4>
                <ul>
                    <li><strong>临时性处理 (Ad hoc)</strong> - 遇到约束再想办法</li>
                    <li><strong>保守设定点</strong> - 设定值远离约束边界</li>
                    <li><strong>饱和处理</strong> - 超出限制时简单截断</li>
                    <li><strong>积分饱和</strong> - 防止积分器饱和的技巧</li>
                </ul>
                
                <div class="code-block">
# 经典控制的约束处理
def classical_constraint_handling():
    # 1. 保守的设定点
    setpoint = 0.8 * constraint_limit
    
    # 2. PID控制器
    u = pid_controller(error)
    
    # 3. 简单饱和处理
    if u > u_max:
        u = u_max
    elif u < u_min:
        u = u_min
    
    # 问题：积分饱和、性能损失
    return u
                </div>
                
                <div class="pros-cons-grid">
                    <div class="pros">
                        <h4>✅ 优点</h4>
                        <ul>
                            <li>实现简单</li>
                            <li>计算量小</li>
                            <li>鲁棒性好</li>
                            <li>工程经验丰富</li>
                        </ul>
                    </div>
                    <div class="cons">
                        <h4>❌ 缺点</h4>
                        <ul>
                            <li>次优操作</li>
                            <li>保守设计</li>
                            <li>积分饱和问题</li>
                            <li>无法预测约束违反</li>
                        </ul>
                    </div>
                </div>
                
                <div class="graph-container">
                    <div class="graph-title">经典控制的约束处理</div>
                    <div class="graph-visual">
                        <div style="position: absolute; top: 20%; left: 0; right: 0; height: 2px; background: #e74c3c; border-top: 2px dashed #e74c3c;"></div>
                        <div style="position: absolute; top: 60%; left: 0; width: 100%; height: 3px; background: #3498db;"></div>
                        <div style="position: absolute; top: 60%; left: 10%; width: 8px; height: 8px; background: #f39c12; border-radius: 50%;"></div>
                        <div style="position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); color: #666;">
                            设定点远离约束 → 安全但次优
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="method-card predictive">
                <h3 class="method-title">🧠 预测控制方法</h3>
                
                <h4>约束处理策略</h4>
                <ul>
                    <li><strong>内建约束</strong> - 约束直接嵌入优化问题</li>
                    <li><strong>最优设定点</strong> - 设定值可以在约束边界</li>
                    <li><strong>预测约束违反</strong> - 提前预防约束违反</li>
                    <li><strong>软约束</strong> - 允许临时违反次要约束</li>
                </ul>
                
                <div class="code-block">
# MPC的约束处理
def mpc_constraint_handling():
    # 1. 优化问题直接包含约束
    minimize: Σ[||x-r||²Q + ||u||²R]
    subject_to:
        x[k+1] = A*x[k] + B*u[k]    # 动态约束
        u_min ≤ u[k] ≤ u_max        # 硬约束
        x_min ≤ x[k] ≤ x_max        # 状态约束
        slack ≥ 0                   # 软约束
    
    # 2. 最优解自然满足所有约束
    return optimal_u
                </div>
                
                <div class="pros-cons-grid">
                    <div class="pros">
                        <h4>✅ 优点</h4>
                        <ul>
                            <li>最优操作</li>
                            <li>约束严格满足</li>
                            <li>预测能力</li>
                            <li>多变量处理</li>
                        </ul>
                    </div>
                    <div class="cons">
                        <h4>❌ 缺点</h4>
                        <ul>
                            <li>计算复杂</li>
                            <li>需要准确模型</li>
                            <li>参数调节困难</li>
                            <li>求解时间长</li>
                        </ul>
                    </div>
                </div>
                
                <div class="graph-container">
                    <div class="graph-title">MPC的约束处理</div>
                    <div class="graph-visual">
                        <div style="position: absolute; top: 20%; left: 0; right: 0; height: 2px; background: #e74c3c; border-top: 2px dashed #e74c3c;"></div>
                        <div style="position: absolute; top: 25%; left: 0; width: 100%; height: 3px; background: #2ecc71;"></div>
                        <div style="position: absolute; top: 25%; left: 80%; width: 8px; height: 8px; background: #f39c12; border-radius: 50%;"></div>
                        <div style="position: absolute; bottom: 10px; left: 50%; transform: translateX(-50%); color: #666;">
                            设定点接近约束 → 最优操作
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="optimal-operation">
            <h2 style="color: #333; text-align: center;">🎯 最优操作的重要性</h2>
            
            <div class="highlight-stat">
                <div class="stat-number">15-30%</div>
                <div class="stat-label" style="color: #333;">MPC相比经典控制的性能提升</div>
            </div>
            
            <p style="text-align: center; font-size: 1.2em; color: #666;">
                <strong>"最优操作点往往接近约束"</strong> - 这是为什么？
            </p>
            
            <div class="operation-comparison">
                <div class="operation-scenario suboptimal">
                    <h3 style="color: #e74c3c;">❌ 次优操作 (经典控制)</h3>
                    <div class="code-block">
# 保守策略
setpoint = 0.7 * constraint_limit
safety_margin = 30%

# 结果
production_rate = 70%
energy_efficiency = 65%
profit_margin = 60%
                    </div>
                    <p><strong>问题：</strong>过度保守，浪费系统潜力</p>
                </div>
                
                <div class="operation-scenario optimal">
                    <h3 style="color: #2ecc71;">✅ 最优操作 (MPC)</h3>
                    <div class="code-block">
# 最优策略  
setpoint = 0.95 * constraint_limit
intelligent_prediction = true

# 结果
production_rate = 95%
energy_efficiency = 88%
profit_margin = 92%
                    </div>
                    <p><strong>优势：</strong>充分利用系统能力，接近理论极限</p>
                </div>
            </div>
        </div>
        
        <div class="example-scenarios">
            <h2 style="color: #333; text-align: center;">🏭 实际应用场景</h2>
            
            <div class="scenario-grid">
                <div class="scenario-card">
                    <h4 style="color: #e74c3c;">🏭 化工反应器</h4>
                    <p><strong>经典控制：</strong></p>
                    <ul>
                        <li>温度设定点：350°C (安全上限400°C)</li>
                        <li>安全裕度：50°C</li>
                        <li>产量：80%额定值</li>
                    </ul>
                    <p><strong>MPC控制：</strong></p>
                    <ul>
                        <li>温度设定点：395°C (动态调整)</li>
                        <li>预测性约束管理</li>
                        <li>产量：96%额定值</li>
                    </ul>
                </div>
                
                <div class="scenario-card">
                    <h4 style="color: #3498db;">🚗 自动驾驶</h4>
                    <p><strong>经典控制：</strong></p>
                    <ul>
                        <li>保持大安全距离</li>
                        <li>转向角度保守</li>
                        <li>速度远低于限速</li>
                    </ul>
                    <p><strong>MPC控制：</strong></p>
                    <ul>
                        <li>动态安全距离</li>
                        <li>最优轨迹规划</li>
                        <li>接近限速的安全驾驶</li>
                    </ul>
                </div>
                
                <div class="scenario-card">
                    <h4 style="color: #f39c12;">⚡ 电力系统</h4>
                    <p><strong>经典控制：</strong></p>
                    <ul>
                        <li>发电量保守设定</li>
                        <li>大旋转备用容量</li>
                        <li>系统利用率：70%</li>
                    </ul>
                    <p><strong>MPC控制：</strong></p>
                    <ul>
                        <li>需求预测优化发电</li>
                        <li>动态备用管理</li>
                        <li>系统利用率：90%</li>
                    </ul>
                </div>
                
                <div class="scenario-card">
                    <h4 style="color: #9b59b6;">🤖 机器人控制</h4>
                    <p><strong>经典控制：</strong></p>
                    <ul>
                        <li>速度限制保守</li>
                        <li>大安全停止距离</li>
                        <li>生产效率：75%</li>
                    </ul>
                    <p><strong>MPC控制：</strong></p>
                    <ul>
                        <li>最优速度轨迹</li>
                        <li>预测性碰撞避免</li>
                        <li>生产效率：93%</li>
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="intro-section">
            <h2 style="color: #ffd700; margin-top: 0;">🚀 关键洞察</h2>
            <div style="font-size: 1.1em; text-align: left; max-width: 800px; margin: 0 auto;">
                <p><strong>🎯 约束不是敌人，而是优化的边界</strong></p>
                <p>• 经典控制把约束当作"要避免的危险"</p>
                <p>• MPC把约束当作"可以充分利用的资源"</p>
                <br>
                <p><strong>📈 最优操作的经济价值</strong></p>
                <p>• 石化工业：每年节省数百万美元能源成本</p>
                <p>• 自动驾驶：提高道路通行效率30%</p>
                <p>• 电力系统：减少20%的备用容量需求</p>
                <br>
                <p style="font-style: italic; color: #ffd700; text-align: center;">
                    "约束处理能力决定了控制系统的性能上限"
                </p>
            </div>
        </div>
    </div>
</body>
</html>
